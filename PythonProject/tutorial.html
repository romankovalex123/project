{% extends "base.html" %}

{% block title %}Практика - EllipticLab{% endblock %}

{% block content %}
<div class="tutorial-container">
    <div class="tutorial-header">
        <h1>Практические Операции</h1>
        <p class="tutorial-subtitle">Изучите работу с эллиптическими кривыми на практике</p>
    </div>

    <div class="tutorial-content">
        <!-- Инструкция -->
        <section class="tutorial-section">
            <h2>Как работать с инструментом</h2>
            <div class="instructions">
                <div class="instruction-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3>Задайте параметры кривой</h3>
                        <p>Введите коэффициенты a, b и модуль p для определения эллиптической кривой</p>
                    </div>
                </div>
                <div class="instruction-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3>Рассчитайте кривую</h3>
                        <p>Нажмите кнопку "Рассчитать кривую" для визуализации всех точек</p>
                    </div>
                </div>
                <div class="instruction-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h3>Выполняйте операции</h3>
                        <p>Используйте точки P и Q для выполнения арифметических операций</p>
                    </div>
                </div>
                <div class="instruction-step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h3>Генерируйте ключи</h3>
                        <p>Создайте пару ключей ECC для криптографических операций</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Практический инструмент -->
        <section class="tutorial-section">
            <h2>Интерактивный инструмент</h2>
            
            <div class="tool-container">
                <!-- Панель параметров кривой -->
                <div class="tool-panel">
                    <h3>Параметры кривой</h3>
                    <div class="input-group">
                        <label for="paramA">Коэффициент a:</label>
                        <input type="number" id="paramA" value="0" class="param-input">
                    </div>
                    
                    <div class="input-group">
                        <label for="paramB">Коэффициент b:</label>
                        <input type="number" id="paramB" value="7" class="param-input">
                    </div>
                    
                    <div class="input-group">
                        <label for="paramP">Модуль p:</label>
                        <input type="number" id="paramP" value="17" class="param-input">
                    </div>
                    
                    <button id="calculateCurve" class="btn-primary">Рассчитать кривую</button>
                </div>

                <!-- Визуализация -->
                <div class="visualization-panel">
                    <h3>Визуализация кривой</h3>
                    <div class="curve-info">
                        <div id="equationDisplay" class="equation">y² = x³ + 0x + 7 mod 17</div>
                        <div id="pointsCount" class="points-count">Всего точек: 0</div>
                    </div>
                    <div class="canvas-container">
                        <canvas id="curveCanvas" width="500" height="500"></canvas>
                    </div>
                </div>

                <!-- Операции с точками -->
                <div class="operations-panel">
                    <h3>Операции с точками</h3>
                    
                    <div class="point-inputs">
                        <div class="input-group">
                            <label>Точка P (x,y):</label>
                            <div class="coord-inputs">
                                <input type="number" id="point1X" placeholder="x" value="15" class="coord-input">
                                <input type="number" id="point1Y" placeholder="y" value="13" class="coord-input">
                            </div>
                        </div>
                        
                        <div class="input-group">
                            <label>Точка Q (x,y):</label>
                            <div class="coord-inputs">
                                <input type="number" id="point2X" placeholder="x" value="2" class="coord-input">
                                <input type="number" id="point2Y" placeholder="y" value="10" class="coord-input">
                            </div>
                        </div>
                        
                        <div class="input-group">
                            <label>Скаляр k:</label>
                            <input type="number" id="scalarK" value="2" class="param-input">
                        </div>
                    </div>

                    <div class="operation-buttons">
                        <button id="addPoints" class="btn-secondary">P + Q</button>
                        <button id="doublePoint" class="btn-secondary">2P</button>
                        <button id="multiplyPoint" class="btn-secondary">kP</button>
                    </div>

                    <div id="operationResult" class="result-display">
                        Результат операции появится здесь
                    </div>
                </div>

                <!-- Генерация ключей -->
                <div class="crypto-panel">
                    <h3>Генерация ключей ECC</h3>
                    
                    <div class="input-group">
                        <label>Генератор G (x,y):</label>
                        <div class="coord-inputs">
                            <input type="number" id="generatorX" placeholder="x" value="15" class="coord-input">
                            <input type="number" id="generatorY" placeholder="y" value="13" class="coord-input">
                        </div>
                    </div>
                    
                    <button id="generateKeys" class="btn-primary">Сгенерировать ключи</button>
                    
                    <div class="key-results">
                        <div class="key-item">
                            <label>Приватный ключ:</label>
                            <span id="privateKey">-</span>
                        </div>
                        <div class="key-item">
                            <label>Публичный ключ:</label>
                            <span id="publicKey">-</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Примеры -->
        <section class="tutorial-section">
            <h2>Примеры для экспериментов</h2>
            <div class="examples-grid">
                <div class="example-card">
                    <h4>Кривая secp256k1 (упрощенная)</h4>
                    <p>a=0, b=7, p=17</p>
                    <p>Генератор: (15,13)</p>
                    <button class="btn-example" onclick="loadExample(0, 7, 17, 15, 13)">Загрузить</button>
                </div>
                <div class="example-card">
                    <h4>Другая кривая</h4>
                    <p>a=2, b=3, p=17</p>
                    <p>Генератор: (5,1)</p>
                    <button class="btn-example" onclick="loadExample(2, 3, 17, 5, 1)">Загрузить</button>
                </div>
                <div class="example-card">
                    <h4>Большее поле</h4>
                    <p>a=1, b=1, p=23</p>
                    <p>Генератор: (3,10)</p>
                    <button class="btn-example" onclick="loadExample(1, 1, 23, 3, 10)">Загрузить</button>
                </div>
            </div>
        </section>
    </div>
</div>

<!-- Уведомления -->
<div id="notification" class="notification hidden"></div>

<script>
function loadExample(a, b, p, gx, gy) {
    document.getElementById('paramA').value = a;
    document.getElementById('paramB').value = b;
    document.getElementById('paramP').value = p;
    document.getElementById('generatorX').value = gx;
    document.getElementById('generatorY').value = gy;
    
    // Автоматически рассчитываем кривую
    setTimeout(() => {
        document.getElementById('calculateCurve').click();
    }, 100);
}
</script>
{% endblock %}